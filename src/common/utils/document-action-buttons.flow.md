# 문서 액션 버튼 노출 흐름도

## 결재단계 상태 용어 (본인 기준)

결재 단계를 **이전 단계 / 나 / 이후 단계**의 승인 여부로 보았을 때 쓰는 용어이다.  
(o = 완료·승인됨, x = 미처리·대기)

| 결재단계 (본인 기준) | 이전 | 나 | 이후 | 용어   |
| ------------------- | :--: | :-: | :--: | ------ |
|                     |  x   |  x  |  x   | 대기중 |
|                     |  o   |  x  |  x   | 진행중 |
|                     |  o   |  o  |  x   | 완료   |
|                     |  o   |  o  |  o   | 종료   |

- **대기중**: 아직 내 차례가 오기 전 (이전 단계도 미처리).
- **진행중**: 이전 단계는 모두 완료, 내 단계가 대기 중.
- **완료**: 내 단계까지 승인 완료, 이후 단계는 대기이거나 내 단계가 마지막.
- **종료**: 모든 단계 승인 완료. 단, 모든 결재단계가 끝난게 아닌 내 다음 단계까지의 승인만을 의미함. 내가 마지막단계라면 종료 상태는 없음.

---

문서 상세 화면에서 **역할(기안자/결재자)** 과 **문서·결재 상태**에 따라 노출할 버튼을 다음 다섯 가지로 구분한다.

| 구분             | 설명                                           |
| ---------------- | ---------------------------------------------- |
| `DRAFT`          | 임시저장, 삭제, 문서상신 등 초안·상신 전 액션  |
| `MODIFY`         | 문서수정 (대기중인 문서에 대한 기안자 수정)    |
| `STEP_PENDING`   | 결재/협의 단계에서의 승인·반려 등 대기 중 액션 |
| `STEP_APPROVED`  | 승인취소 (이미 승인/완료한 단계 취소)          |
| `IMPLEMENTATION` | 시행·시행완료 등 시행 단계 액션                |

---

## 1. DRAFT (초안)

**대상:** 기안자

- **상태:** 

1. 임시저장

- **액션**
    - 임시저장된 문서 삭제
    - 문서상신 (결재선 진행 시작)

문서가 결재 흐름에 올라가기 전, 초안 단계에서 쓰는 버튼들을 `DRAFT`로 노출한다.

---

## 2. MODIFY (문서수정)

**대상:** 기안자, 결재자

- **상태:**

1. 임시저장
2. 결재진행중 -> 합의/결재 -> 진행중
3. 결재진행중 -> 합의/결재 -> 완료

- **액션** 
기안자, 결재자가 **문서수정** 가능
문서가 기안되기 전에 기안자 혹은 결재가 진행 중(PENDING)이지만, 내가 결재를 진행해야하는 단계나 아직 다음 결재자가 처리하기 전 등 “진행중, 완료”인 동안의 결재자가 본문을 수정할 수 있으며 `MODIFY`를 노출한다.

---

## 3. STEP_PENDING (단계 대기 액션)

**대상:** 결재자

**상태:** 
1. 결재진행중 -> 합의/결재 -> 진행중

즉, “내 차례”인 협의·결재 단계에서 **승인/반려**를 할 수 있을 때 `STEP_PENDING`을 노출한다.  

---

## 4. STEP_APPROVED (승인취소)

**대상:** 결재자

- **상태**
1. 결재진행중 -> 합의/결재 -> 완료
2. 승인완료 -> 합의/결재 -> 완료

- **액션** 
**승인취소**
이미 본인이 승인(또는 협의 완료)했으며 이 다음단계 결재자가 없거나 아직 승인을하지 않은 "완료"상태에서 `STEP_APPROVED`를 노출한다.

---

## 5. IMPLEMENTATION (시행)

**대상:** 시행자(결재·시행 역할을 가진 사용자)

- **상태:** 
1. 승인완료 -> 시행 -> 진행중
- **액션:** **시행완료**

결재가 모두 끝나고 시행 단계에 들어간 문서에 대해, 시행 완료를 할 수 있을 때 `IMPLEMENTATION`을 노출한다.

---

## 요약 표

| 버튼 구분      | 주체         | 관련 상태/조건                                                                 |
| -------------- | ------------ | ------------------------------------------------------------------------------ |
| DRAFT          | 기안자       | 임시저장 → 삭제, 문서상신                                                      |
| MODIFY         | 기안자, 결재자 | 임시저장 / 결재진행중(합의·결재 진행중·완료) → 문서수정                         |
| STEP_PENDING   | 결재자       | 결재진행중 → 합의·결재 진행중(내 차례) → 승인·반려                              |
| STEP_APPROVED  | 결재자       | 합의·결재 완료 또는 승인완료 후 결재 완료(다음 단계 없거나 미승인) → 승인취소  |
| IMPLEMENTATION | 시행자       | 승인완료 → 시행 진행중 → 시행완료                                              |

이 흐름을 기준으로 `getDocumentActionButtons(document, userId)`에서 위 다섯 값 중 노출할 것을 배열로 반환하면 된다.
